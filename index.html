<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Planner de AlimentaciÃ³n</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="favicon.ico">
  <link rel="manifest" href="manifest.json">
  <style>
    body { font-family: Arial, sans-serif; background: #f9f9f9; padding: 10px; margin:0; }
    header { position: sticky; top:0; background:#fff; padding:10px; box-shadow:0 1px 3px rgba(0,0,0,0.1); text-align:center; }
    header h1 { margin:0; font-size:1.2rem; color:#2c3e50; }
    nav { display:flex; justify-content:center; gap:10px; margin:15px 0; }
    nav button { background:#3498db; color:#fff; border:none; padding:8px 12px; border-radius:5px; font-size:0.9rem; }
    .marcador { background:#fff; padding:15px; border-radius:8px; box-shadow:0 0 10px rgba(0,0,0,0.1); margin-bottom:15px; }
    .marcador p { margin:5px 0; }
    .semana { background:#fff; border-radius:8px; margin-bottom:15px; box-shadow:0 0 8px rgba(0,0,0,0.1); }
    summary { cursor:pointer; background:#2980b9; color:#fff; padding:10px; border-radius:8px; font-weight:bold; font-size:1rem; }
    .dia { padding:10px; border-top:1px solid #eee; }
    .dia h4 { margin:0 0 8px; color:#2980b9; }
    .comida { display:flex; align-items:center; justify-content:space-between; margin:5px 0; padding:8px; border-radius:5px; }
    .detalle { font-size:0.8rem; color:#666; margin-top:4px; margin-left:20px; }
    .kcal { font-weight:bold; margin-right:10px; }
  </style>
</head>
<body>
  <header>
    <h1>Planner de AlimentaciÃ³n</h1>
  </header>
  <nav>
    <button id="btnPlanner">Planner</button>
    <button id="btnLista">Lista de Compras</button>
  </nav>
  <div id="viewPlanner">
    <div class="marcador">
      <h2>ðŸ“Š Progreso Total</h2>
      <p>Comidas cumplidas: <span id="comidasTotal">0</span> / 408</p>
      <p>Kcal netas: <span id="kcalTotal">0</span></p>
    </div>
    <!-- Generar 12 semanas -->
    <div id="semanasContainer"></div>
  </div>
  <div id="viewLista" style="display:none;">
    <h2>ðŸ›’ Lista de Compras (cada 2 semanas)</h2>
    <div id="listaContainer"></div>
  </div>

  <script>
    const REST_DIA = 2200;
    const MEALS = [
      {key:'des', kcal:150}, {key:'alm', kcal:200}, {key:'mer', kcal:100}, {key:'cen', kcal:250}
    ];
    const WORKOUT_DAYS = ['0','2','5']; // lunes=0, miercoles=2, sabado=5
    const MAX_WEEKS = 12;
    const container = document.getElementById('semanasContainer');

    // Crear plantillas semanales
    for(let s=1; s<=MAX_WEEKS; s++){
      const weekDiv = document.createElement('details');
      weekDiv.className = 'semana';
      weekDiv.innerHTML = `<summary>Semana ${s} â€” âœ… <span id="count_${s}">0/34</span> | ðŸ”¥ <span id="kcal_${s}">0</span> kcal</summary>`;
      for(let d=0; d<7; d++){
        const dayDiv = document.createElement('div');
        dayDiv.className = 'dia';
        const dayName = ['Lunes','Martes','MiÃ©rcoles','Jueves','Viernes','SÃ¡bado','Domingo'][d];
        dayDiv.innerHTML = `<h4>${dayName}</h4>`;
        // comidas
        MEALS.forEach(m=>{
          const c = document.createElement('div'); c.className='comida'; c.style.background='#f9f9f9';
          c.innerHTML = `<span><strong>${m.key.toUpperCase()}</strong> <span class="kcal">${m.kcal} kcal</span><label><input type="checkbox" id="s${s}_d${d}_${m.key}"/></label></span>`;
          dayDiv.appendChild(c);
          const det = document.createElement('div'); det.className='detalle'; det.innerText = 'detalle...'; dayDiv.appendChild(det);
        });
        // workouts en L-M-S
        if(WORKOUT_DAYS.includes(d.toString())){
          [['cardio',-250],['musculacion',-220]].forEach(w=>{
            const c = document.createElement('div'); c.className='comida'; c.style.background='#f0f0f0';
            c.innerHTML = `<span><strong>${w[0]}</strong> <span class="kcal">${w[1]} kcal</span><label><input type="checkbox" id="s${s}_d${d}_${w[0]}"/></label></span>`;
            dayDiv.appendChild(c);
            const det = document.createElement('div'); det.className='detalle'; det.innerText = 'entreno'; dayDiv.appendChild(det);
          });
        }
        weekDiv.appendChild(dayDiv);
      }
      container.appendChild(weekDiv);
      // listener summary toggle
      weekDiv.addEventListener('change', ()=>actualizarSemana(s));
    }

    function actualizarSemana(s){
      const checkboxes = Array.from(document.querySelectorAll(`[id^="s${s}_d"] input[type=checkbox]`));
      let count=0, kcal=0;
      const daysDone = new Set();
      checkboxes.forEach(cb=>{
        const parts = cb.id.split('_'); const day=parts[1].slice(1);
        if(cb.checked){
          count++;
          const k = parseInt(cb.parentNode.querySelector('.kcal').innerText);
          kcal += k;
          daysDone.add(day);
        }
      });
      const rest = daysDone.size * REST_DIA;
      kcal -= rest;
      document.getElementById(`count_${s}`).innerText = `${count}/34`;
      document.getElementById(`kcal_${s}`).innerText = kcal;
      // actualizar total
      actualizarTotal();
    }
    function actualizarTotal(){
      let totalC=0, totalK=0;
      for(let s=1; s<=MAX_WEEKS; s++){
        const [c,k] = [
          ...document.getElementById(`count_${s}`).innerText.split('/')
        ];
        totalC += parseInt(c);
        totalK += parseInt(document.getElementById(`kcal_${s}`).innerText);
      }
      document.getElementById('comidasTotal').innerText = totalC;
      document.getElementById('kcalTotal').innerText = totalK;
    }

    // Lista de Compras cada 2 semanas
    document.getElementById('btnLista').onclick = ()=>{
      document.getElementById('viewPlanner').style.display='none';
      const lista = document.getElementById('viewLista'); lista.style.display='block';
      const lc = document.getElementById('listaContainer'); lc.innerHTML='';
      for(let s=1; s<=MAX_WEEKS; s+=2){
        const box = document.createElement('div'); box.innerHTML = `<h3>Semanas ${s}& ${s+1}</h3><ul><li>Zuchini...</li><li>AtÃºn...</li></ul>`;
        lc.appendChild(box);
      }
    };
    document.getElementById('btnPlanner').onclick = ()=>{
      document.getElementById('viewLista').style.display='none';
      document.getElementById('viewPlanner').style.display='block';
    };
  </script>
</body>
</html>
